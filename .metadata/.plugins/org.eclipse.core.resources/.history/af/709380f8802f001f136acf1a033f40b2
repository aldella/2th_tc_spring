<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardMapper">
	<sql id="selectBoard">
		SELECT
			BOARD_NO boardNo,
			BOARD_TITLE boardTitle,
			BOARD_CONTENT boardContent,
			BOARD_WRITER boardWriter,
			CREATE_DATE createDate,
			ORIGIN_NAME originName	
	</sql>

	<select id="findByConditionAndKeyword" parameterType="hashmap" resultType="board">
		<include refid="selectBoard"/>	
		FROM
				BOARD
		WHERE
				STATUS = 'Y'
		<choose>
			<when test="condition == 'writer'">
				AND BOARD_WRITER
			</when>
			<when test="condition == 'title'">
				AND BOARD_TITLE
			</when>
			<when test="condition == 'content'">
				AND BOARD_CONTENT
			</when>
		</choose>
				LIKE '%' || #{keyword} || '%' 
		ORDER
			BY
				BOARD_NO DESC
	</select>
	
	
	<select id="searchCount" parameterType="hashmap" resultType="int">
		select
		        count(board_no)
		from
		        board
		where
		        status='Y'
		<if test="condition == 'writer'">
			and
			        board_WRITER
		</if>
		<if test="condition == 'title'">
			and
			        board_title
        </if>
        <if test="condition == 'content'">
			and        
			        board_content
		</if>		        
		LIKE '%' || #{keyword} || '%' 
	</select>
	
	<select id="boardCount" resultType="_int">
		SELECT
				COUNT(BOARD_NO)
		FROM
				BOARD
		WHERE
				STATUS = 'Y'
	</select>

	<select id="findAll" resultType="board" parameterType="map">
	<include refid="selectBoard"/>
	from
	    (
			<include refid="selectBoard"/>
	        , ROWNUM RNUM
	    from (
	        select
				<include refid="selectBoard"/>
	        from 
	            board
	        where
	            STATUS = 'Y'
	        ORDER
	        BY
	            BOARD_NO DESC
	        )
	    )
	WHERE
	    RNUM BETWEEN #{startValue} AND #{endValue}
	
	</select>
</mapper>